<!-- control.html ‚Äî Random Live Cams (CONTROL) v2.3.9 ‚Äî READY (Neo-Atlas / Newsroom)
  ‚úÖ Alineado con control.js v2.3.9 (IDs compatibles + aliases)
  ‚úÖ Version sentinel + cache-bust unificado
  ‚úÖ REPAIR MODE: control.html?repair=1
  ‚úÖ Diagn√≥stico on-screen (errores JS)
  ‚úÖ Secci√≥n KEY/Sala para fijar el "key" sin tocar la URL (si tu control.js lo soporta por storage)
-->
<!doctype html>
<html lang="es" data-theme="dark" data-ui="neo-atlas" data-ui-skin="newsroom">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b0f14" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="robots" content="noindex,nofollow" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <title>Random Live Cams ‚Äî Control</title>
  <meta name="description" content="Random Live Cams ‚Äî Control Room (votaci√≥n, overlays, ticker, cat√°logo CCTV, ads notice, bot IRC, auto t√≠tulo Helix)." />

  <!-- ‚úÖ Versi√≥n ACTUAL del control -->
  <script>window.APP_VERSION = "2.3.9";</script>

  <!-- ‚úÖ Version sentinel: recarga suave al actualizar (NO borra storage / NO toca tokens) -->
  <script>
    (() => {
      "use strict";
      try{
        const V = String(window.APP_VERSION || "");
        if(!V) return;

        const K = "rlc_app_version_seen_v1";
        const prev = (() => { try { return localStorage.getItem(K) || ""; } catch(_) { return ""; } })();

        if(prev !== V){
          try { localStorage.setItem(K, V); } catch(_){}
          const u = new URL(location.href);
          if(!u.searchParams.has("v")){
            u.searchParams.set("v", V);
            location.replace(u.toString());
            return;
          }
        }

        if("serviceWorker" in navigator){
          navigator.serviceWorker.getRegistration()
            .then(reg => { try{ reg && reg.update && reg.update(); }catch(_){}})
            .catch(()=>{});
        }
      }catch(_){}
    })();
  </script>

  <!-- ‚úÖ Cache-bust ALINEADO con APP_VERSION (2.3.9) -->
  <link rel="stylesheet" href="./styles.css?v=2.3.9" />

  <!-- ‚úÖ REPAIR MODE: control.html?repair=1 -->
  <script>
    (() => {
      try{
        const u = new URL(location.href);
        if(!u.searchParams.has("repair")) return;

        const go = async () => {
          try{
            if("serviceWorker" in navigator){
              const regs = await navigator.serviceWorker.getRegistrations();
              await Promise.all(regs.map(r => r.unregister()));
            }
          }catch(_){}
          try{
            if(window.caches && caches.keys){
              const keys = await caches.keys();
              await Promise.all(keys.map(k => caches.delete(k)));
            }
          }catch(_){}
          try{ localStorage.clear(); }catch(_){}
          try{ sessionStorage.clear(); }catch(_){}

          u.searchParams.delete("repair");
          u.searchParams.set("v", window.APP_VERSION || "repair");
          location.replace(u.toString());
        };

        go();
      }catch(_){}
    })();
  </script>

  <!-- Newsroom Skin (solo control.html) -->
  <style>
    html,body{height:100%}
    body{margin:0}

    :root{
      --news-bg0:#05060b;--news-bg1:#070b14;--news-bg2:#0a1528;
      --news-panel:rgba(10,14,22,.72);--news-panel2:rgba(10,14,22,.86);
      --news-stroke:rgba(255,255,255,.10);--news-stroke2:rgba(255,255,255,.16);
      --news-text:rgba(255,255,255,.92);--news-muted:rgba(255,255,255,.64);
      --news-accent:#ff3b3b;--news-accent2:#37d6ff;--news-ok:#19e28a;--news-bad:#ff5a5a;
      --news-glow:0 18px 60px rgba(0,0,0,.55);--news-radius:16px;
    }

    body.mode-control{
      background:
        radial-gradient(1200px 900px at 20% 0%, rgba(55,214,255,.14), transparent 55%),
        radial-gradient(900px 700px at 85% 15%, rgba(255,59,59,.10), transparent 55%),
        linear-gradient(180deg,var(--news-bg0),var(--news-bg1) 35%,var(--news-bg2));
      color:var(--news-text);
      overflow-x:hidden;
    }

    body.mode-control::before{
      content:"";position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.75;
      background:
        radial-gradient(900px 700px at 50% 40%, rgba(0,0,0,.20), rgba(0,0,0,.72)),
        repeating-linear-gradient(0deg, rgba(255,255,255,.05) 0 1px, rgba(255,255,255,0) 1px 3px),
        linear-gradient(90deg, rgba(55,214,255,.08), transparent 35%, rgba(255,59,59,.07));
      mix-blend-mode:screen;
    }

    body.mode-control::after{
      content:"";position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.20;
      background:repeating-linear-gradient(90deg, rgba(255,255,255,.05) 0 1px, rgba(255,255,255,0) 1px 18px);
      filter:blur(.2px);transform:translateZ(0);animation:rlcGridDrift 12s linear infinite;
    }
    @keyframes rlcGridDrift{from{transform:translate3d(0,0,0)}to{transform:translate3d(-18px,0,0)}}
    @media (prefers-reduced-motion: reduce){body.mode-control::after{animation:none}}
    @supports not (mix-blend-mode: screen){body.mode-control::before{mix-blend-mode:normal;opacity:.28}}

    .controlWrap{position:relative;z-index:1}

    /* ‚úÖ Header NO sticky */
    .controlHeader{
      position:relative;
      top:auto;
      z-index:2;
      background:linear-gradient(90deg, rgba(255,59,59,.18), rgba(10,14,22,.88) 25%, rgba(55,214,255,.16));
      border:1px solid var(--news-stroke);box-shadow:var(--news-glow);
      backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
      border-radius:var(--news-radius);overflow:hidden;
      padding:14px 14px 12px;margin-bottom:14px;
    }

    .controlHeader::after{
      content:"";position:absolute;left:0;right:0;bottom:0;height:1px;
      background:linear-gradient(90deg, transparent, rgba(55,214,255,.45), rgba(255,59,59,.40), transparent);opacity:.65;
    }

    .controlHeader::before{
      content:"LIVE ‚Ä¢ CONTROL ROOM";position:absolute;top:10px;right:12px;
      font:950 11px/1 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      letter-spacing:.14em;color:rgba(255,255,255,.92);
      background:rgba(255,59,59,.18);border:1px solid rgba(255,59,59,.35);
      padding:6px 10px;border-radius:999px;
    }

    .controlTitle .kicker{color:rgba(255,255,255,.75);letter-spacing:.26em}
    .controlTitle .name{text-transform:uppercase;letter-spacing:.06em}

    .card{
      background:var(--news-panel);
      border:1px solid var(--news-stroke);
      border-radius:var(--news-radius);
      box-shadow:var(--news-glow);
      position:relative;
      overflow:hidden
    }

    .card::before{
      content:"";position:absolute;left:0;right:0;top:0;height:3px;
      background:linear-gradient(90deg, rgba(255,59,59,.85), rgba(55,214,255,.85));
      opacity:.80
    }

    .cardTitle{font-weight:950;letter-spacing:.06em;text-transform:uppercase;color:rgba(255,255,255,.86)}

    .pill{
      border:1px solid var(--news-stroke2)!important;
      background:rgba(0,0,0,.28)!important;
      backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)
    }
    .pill--ok{border-color:rgba(25,226,138,.35)!important;box-shadow:0 0 0 1px rgba(25,226,138,.12) inset}
    .pill--bad{border-color:rgba(255,90,90,.40)!important;box-shadow:0 0 0 1px rgba(255,90,90,.12) inset}

    .btn{
      border-radius:14px!important;
      border:1px solid rgba(255,255,255,.14)!important;
      background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06))!important;
      box-shadow:0 10px 30px rgba(0,0,0,.30);
      cursor:pointer;
      transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .btn.ghost{background:rgba(0,0,0,.18)!important;border-color:rgba(255,255,255,.12)!important}
    .btn:hover{
      transform:translateY(-1px);
      border-color:rgba(55,214,255,.25)!important;
      box-shadow:0 14px 36px rgba(0,0,0,.38),0 0 0 1px rgba(55,214,255,.08) inset
    }

    .input,.select{
      border-radius:14px!important;
      border:1px solid rgba(255,255,255,.14)!important;
      background:rgba(0,0,0,.18)!important;
      color:rgba(255,255,255,.92)!important;
      outline:none;
    }

    .hint{color:var(--news-muted)}
    .btn.full{display:block!important;width:100%!important}

    #ctlSelect.select{
      padding:8px!important;border-radius:14px!important;height:auto;max-height:360px;overflow:auto
    }
    #ctlSelect option{padding:8px 10px;border-radius:10px}
    #ctlSelect option:checked{background:rgba(55,214,255,.22)}

    #ctlDiagCard pre{
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.22);
      border-radius:12px;
      padding:10px 12px
    }

    .previewWrap{
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      overflow:hidden;
      background:rgba(0,0,0,.22);
      margin-top:10px;
      aspect-ratio: 16 / 9;
    }
    .previewFrame{
      width:100%;
      height:100%;
      border:0;
      display:block;
    }

    :where(.controlWrap){
      max-width:1180px;
      margin:18px auto;
      padding:14px;
      box-sizing:border-box;
    }
    :where(.controlGrid){
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));
      gap:14px;
      align-items:start;
    }
    :where(.card){
      padding:14px;
      box-sizing:border-box;
    }
    :where(.row){
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      margin:10px 0;
    }
    :where(.row > span){flex:1; min-width:0}
    :where(.row .input, .row .select){flex:0 0 160px; min-width:160px}
    :where(.row2){
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    :where(.controls3){
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    :where(.mono){
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      letter-spacing:.02em;
    }
    :where(.dot){opacity:.65; padding:0 6px}
    :where(.nowTitle){font-weight:900; font-size:18px; margin-top:6px}
    :where(.nowMeta){opacity:.9; margin-top:6px}

    #ctlUpdateBanner{
      display:none;
      margin-top:12px;
      border:1px solid rgba(255,90,90,.35);
      background:rgba(255,90,90,.10);
      border-radius:14px;
      padding:10px 12px;
    }

    @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))){
      .controlHeader,.pill{
        backdrop-filter:none!important;
        -webkit-backdrop-filter:none!important;
        background:rgba(10,14,22,.92)!important
      }
    }
  </style>
</head>

<body class="mode-control">
  <main class="controlWrap" role="application" aria-label="Random Live Cams ‚Äî Control Room">
    <header class="controlHeader">
      <div class="controlTitle">
        <div class="kicker">CONTROL ROOM</div>
        <div class="name">Random Live Cams</div>
      </div>
      <div class="pill mono" id="ctlStatus" aria-live="polite">Conectando‚Ä¶</div>
    </header>

    <!-- (Opcional) Banner de update/mismatch (control.js puede mostrarlo) -->
    <section id="ctlUpdateBanner" class="card" aria-live="polite">
      <div class="cardTitle">Actualizaci√≥n detectada</div>
      <div class="hint" style="margin-top:8px">
        Parece que el <b>player</b> y el <b>control</b> no van a la misma versi√≥n, o hay una update pendiente.
      </div>
      <div class="row2" style="margin-top:10px">
        <button id="ctlUpdateReload" class="btn full" type="button">Recargar</button>
        <button id="ctlUpdateHide" class="btn ghost full" type="button">Ocultar</button>
      </div>
    </section>

    <!-- DIAGN√ìSTICO EN PANTALLA -->
    <section id="ctlDiagCard" class="card" style="display:none; margin-top:12px">
      <div class="cardTitle">Diagn√≥stico</div>
      <div class="hint" style="margin:10px 0 8px">Se detect√≥ un error JS. Copia este texto y p√©gamelo.</div>
      <pre id="ctlDiagText" class="mono" style="white-space:pre-wrap; margin:0; opacity:.92"></pre>
      <div class="hint" style="margin-top:10px">Tip: prueba <b>control.html?repair=1</b> para limpiar cach√©s.</div>
    </section>

    <section class="controlGrid" aria-label="Panel de control">

      <!-- KEY / SALA -->
      <div class="card">
        <div class="cardTitle">Sala / KEY</div>
        <div class="hint">Esto suele venir por URL (<span class="mono">?key=...</span>). Si tu <span class="mono">control.js</span> soporta storage, aqu√≠ lo fijas sin tocar enlaces.</div>

        <label class="row" for="ctlKey">
          <span>KEY</span>
          <input id="ctlKey" class="input mono" type="text" placeholder="live_xxx..." autocomplete="off" />
        </label>

        <div class="row2">
          <button id="ctlKeyApply" class="btn full" type="button">Aplicar KEY</button>
          <button id="ctlKeyClear" class="btn ghost full" type="button">Limpiar</button>
        </div>

        <div class="hint" style="margin-top:10px">
          Consejo: si abres control y player en varias pesta√±as, usa siempre la misma KEY para que el bus vaya fino.
        </div>

        <!-- Aliases ‚Äúpor si acaso‚Äù (ocultos) -->
        <div style="display:none">
          <input id="ctlRoomKey" type="text" />
          <input id="ctlBusKey" type="text" />
        </div>
      </div>

      <!-- NOW -->
      <div class="card">
        <div class="cardTitle">Ahora</div>
        <div class="nowTitle" id="ctlNowTitle">‚Äî</div>
        <div class="nowMeta">
          <span id="ctlNowPlace">‚Äî</span>
          <span class="dot">‚Ä¢</span>
          <span class="mono" id="ctlNowTimer">--:--</span>
        </div>
        <div class="row2">
          <a id="ctlOrigin" class="btn ghost" href="#" target="_blank" rel="noopener noreferrer">Abrir origen</a>
          <button id="ctlCopyStreamUrl" class="btn" type="button">Copiar URL stream</button>
        </div>

        <div class="row2" style="margin-top:10px">
          <button id="ctlCopyPlayerUrl" class="btn ghost full" type="button">Copiar URL Player</button>
          <button id="ctlCopyObsUrl" class="btn ghost full" type="button">Copiar URL OBS</button>
        </div>
      </div>

      <!-- TRANSPORTE -->
      <div class="card">
        <div class="cardTitle">Transporte</div>
        <div class="controls3">
          <button class="btn" id="ctlPrev" type="button" aria-label="Anterior">‚óÄ</button>
          <button class="btn" id="ctlPlay" type="button" aria-label="Pausa/Reanudar">‚è∏</button>
          <button class="btn" id="ctlNext" type="button" aria-label="Siguiente">‚ñ∂</button>
        </div>
        <button class="btn ghost full" id="ctlShuffle" type="button">üé≤ Mezclar</button>
      </div>

      <!-- AJUSTES -->
      <div class="card">
        <div class="cardTitle">Ajustes</div>

        <label class="row" for="ctlMins">
          <span>Duraci√≥n (min)</span>
          <input id="ctlMins" class="input" type="number" min="1" max="120" step="1" value="5" inputmode="numeric" />
        </label>
        <button id="ctlApplyMins" class="btn full" type="button">Aplicar duraci√≥n</button>

        <label class="row" for="ctlFit">
          <span>Fit</span>
          <select id="ctlFit" class="select">
            <option value="cover">Cover</option>
            <option value="contain">Contain</option>
          </select>
        </label>

        <label class="row" for="ctlHud">
          <span>HUD</span>
          <select id="ctlHud" class="select">
            <option value="on">Mostrar</option>
            <option value="off">Ocultar</option>
          </select>
        </label>

        <label class="row" for="ctlHudDetails">
          <span>Detalles HUD</span>
          <select id="ctlHudDetails" class="select">
            <option value="off">Colapsado</option>
            <option value="on">Expandido</option>
          </select>
        </label>

        <label class="row" for="ctlAutoskip">
          <span>Autoskip (errores)</span>
          <select id="ctlAutoskip" class="select">
            <option value="on">ON</option>
            <option value="off">OFF</option>
          </select>
        </label>

        <label class="row" for="ctlAdfree">
          <span>Adfree</span>
          <select id="ctlAdfree" class="select">
            <option value="off">OFF</option>
            <option value="on">ON (sin YouTube)</option>
          </select>
        </label>

        <button id="ctlApplySettings" class="btn full" type="button">Aplicar ajustes</button>
        <button id="ctlReset" class="btn ghost full" type="button">Reset estado</button>

        <!-- ‚úÖ Aliases opcionales (compat con distintos control.js / botones legacy) -->
        <div style="display:none">
          <button id="ctlApply" type="button"></button>
          <button id="ctlApplyAll" type="button"></button>
          <button id="ctlHudToggle" type="button"></button>
          <button id="ctlSettingsApply" type="button"></button>
          <button id="ctlHudApply" type="button"></button>
          <button id="ctlCfgApply" type="button"></button>
        </div>
      </div>

      <!-- CATALOG MODE -->
      <div class="card">
        <div class="cardTitle">Modo cat√°logo (CCTV)</div>
        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogOn">
            <span>Cat√°logo</span>
            <select id="ctlCatalogOn" class="select">
              <option value="off">OFF</option>
              <option value="on">ON</option>
            </select>
          </label>
          <div class="pill mono" id="ctlCatalogStatus" aria-live="polite">Cat√°logo: ‚Äî</div>
        </div>

        <label class="row" for="ctlCatalogLayout">
          <span>Layout</span>
          <select id="ctlCatalogLayout" class="select">
            <option value="quad">2√ó2 (4 cams)</option>
          </select>
        </label>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogGap">
            <span>Separaci√≥n (px)</span>
            <input id="ctlCatalogGap" class="input" type="number" min="0" max="24" step="1" value="8" inputmode="numeric" />
          </label>
          <label class="row" style="margin:0" for="ctlCatalogLabels">
            <span>Labels</span>
            <select id="ctlCatalogLabels" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogMode">
            <span>Modo</span>
            <select id="ctlCatalogMode" class="select">
              <option value="follow">Follow (1 sigue)</option>
              <option value="sync">Sync (rotan 4)</option>
            </select>
          </label>
          <label class="row" style="margin:0" for="ctlCatalogFollowSlot">
            <span>Follow slot</span>
            <select id="ctlCatalogFollowSlot" class="select">
              <option value="0">Slot 1</option><option value="1">Slot 2</option><option value="2">Slot 3</option><option value="3">Slot 4</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogClickCycle">
            <span>Click cycle</span>
            <select id="ctlCatalogClickCycle" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>
          <label class="row" style="margin:0" for="ctlCatalogYtCookies">
            <span>YT cookies</span>
            <select id="ctlCatalogYtCookies" class="select">
              <option value="on">ON (sesi√≥n)</option>
              <option value="off">OFF (nocookie)</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogWxTiles">
            <span>Weather tiles</span>
            <select id="ctlCatalogWxTiles" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
          </label>
          <label class="row" style="margin:0" for="ctlCatalogWxRefreshSec">
            <span>WX refresh (s)</span>
            <input id="ctlCatalogWxRefreshSec" class="input" type="number" min="10" max="180" step="1" value="30" inputmode="numeric" />
          </label>
        </div>

        <label class="row" for="ctlCatalogMuted">
          <span>Mutear v√≠deos</span>
          <select id="ctlCatalogMuted" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
        </label>

        <div class="row2">
          <button id="ctlCatalogApply" class="btn full" type="button">Aplicar cat√°logo</button>
          <button id="ctlCatalogReset" class="btn ghost full" type="button">Reset cat√°logo</button>
        </div>

        <div class="hint">‚úÖ Muestra 4 cams (CCTV). En player, el HUD de single-cam se oculta cuando cat√°logo est√° ON.</div>
      </div>

      <!-- AUTO TITLE -->
      <div class="card">
        <div class="cardTitle">Twitch: T√≠tulo autom√°tico</div>
        <div class="row2">
          <label class="row" style="margin:0" for="ctlTitleOn">
            <span>Auto-t√≠tulo</span>
            <select id="ctlTitleOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
          </label>
          <div class="pill mono" id="ctlTitleStatus" aria-live="polite">T√≠tulo: ‚Äî</div>
        </div>

        <label class="row" for="ctlTitleClientId"><span>Client ID</span>
          <input id="ctlTitleClientId" class="input" type="text" placeholder="Twitch App Client ID" autocomplete="off" />
        </label>

        <label class="row" for="ctlTitleBroadcasterId"><span>Broadcaster ID</span>
          <input id="ctlTitleBroadcasterId" class="input" type="text" placeholder="ID num√©rico del canal (opcional)" inputmode="numeric" autocomplete="off" />
        </label>

        <label class="row" for="ctlTitleToken"><span>User Token (scope)</span>
          <input id="ctlTitleToken" class="input" type="password" placeholder="Bearer token con channel:manage:broadcast" autocomplete="off" />
        </label>

        <label class="row" for="ctlTitleTemplate"><span>Plantilla</span>
          <input id="ctlTitleTemplate" class="input" type="text" value="üåç Ahora: {title}{placeSep}{place} | GlobalEye.TV" autocomplete="off" />
        </label>

        <label class="row" for="ctlTitleCooldown"><span>Cooldown (s)</span>
          <input id="ctlTitleCooldown" class="input" type="number" min="10" max="180" step="1" value="20" inputmode="numeric" />
        </label>

        <div class="row2">
          <button id="ctlTitleApply" class="btn full" type="button">Aplicar</button>
          <button id="ctlTitleTest" class="btn ghost full" type="button">Test ahora</button>
        </div>

        <button id="ctlTitleReset" class="btn ghost full" type="button" style="margin-top:8px">Reset auto-t√≠tulo</button>

        <div class="hint">Placeholders: <b>{title}</b> <b>{place}</b> <b>{source}</b> <b>{label}</b> <b>{placeSep}</b><br/>Necesita token de usuario con scope <b>channel:manage:broadcast</b>.</div>
      </div>

      <!-- COUNTDOWN -->
      <div class="card">
        <div class="cardTitle">Countdown (overlay en stream)</div>
        <div class="row2">
          <label class="row" style="margin:0" for="ctlCountdownOn">
            <span>Countdown</span>
            <select id="ctlCountdownOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
          </label>
          <div class="pill mono" id="ctlCountdownStatus" aria-live="polite">Countdown: ‚Äî</div>
        </div>

        <label class="row" for="ctlCountdownLabel"><span>Texto</span>
          <input id="ctlCountdownLabel" class="input" type="text" value="FIN DE A√ëO" autocomplete="off" />
        </label>

        <label class="row" for="ctlCountdownTarget"><span>Objetivo</span>
          <input id="ctlCountdownTarget" class="input" type="datetime-local" />
        </label>

        <div class="row2">
          <button id="ctlCountdownApply" class="btn full" type="button">Aplicar countdown</button>
          <button id="ctlCountdownReset" class="btn ghost full" type="button">Reset countdown</button>
        </div>

        <div class="hint">‚úÖ Se env√≠a al player por <b>BroadcastChannel</b> y se guarda en local (con KEY).</div>
      </div>

      <!-- CAM SELECT -->
      <div class="card">
        <div class="cardTitle">Cambiar c√°mara</div>
        <input id="ctlSearch" class="input" type="text" placeholder="Buscar (t√≠tulo / lugar / fuente)‚Ä¶" autocomplete="off" />
        <select id="ctlSelect" class="select" size="10" aria-label="Lista de c√°maras"></select>
        <div class="row2">
          <button id="ctlGo" class="btn full" type="button">Ir</button>
          <button id="ctlBan" class="btn ghost full" type="button">Excluir esta (solo local)</button>
        </div>
        <div class="hint">Doble click en la lista = Ir.</div>
      </div>

      <!-- PREVIEW -->
      <div class="card">
        <div class="cardTitle">Preview (opcional)</div>
        <label class="row" for="ctlPreviewOn">
          <span>Mostrar</span>
          <select id="ctlPreviewOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
        </label>

        <div id="ctlPreviewWrap" class="previewWrap" style="display:none">
          <iframe id="ctlPreview" class="previewFrame" title="Preview stream"
            referrerpolicy="strict-origin-when-cross-origin"
            allow="autoplay; encrypted-media; picture-in-picture"></iframe>
        </div>

        <div class="hint">Para OBS, normalmente OFF (ahorra recursos).</div>

        <!-- Alias oculto -->
        <div style="display:none">
          <select id="ctlPreview" aria-hidden="true"><option value="off">off</option><option value="on">on</option></select>
        </div>
      </div>

      <!-- BGM -->
      <div class="card">
        <div class="cardTitle">M√∫sica ambiente (BGM)</div>
        <label class="row" for="ctlBgmOn"><span>Enable</span>
          <select id="ctlBgmOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
        </label>
        <label class="row" for="ctlBgmVol"><span>Volumen</span>
          <input id="ctlBgmVol" class="input" type="range" min="0" max="1" step="0.01" value="0.25" />
        </label>
        <label class="row" for="ctlBgmTrack"><span>Track</span>
          <select id="ctlBgmTrack" class="select" aria-label="Track BGM"></select>
        </label>
        <div class="controls3">
          <button class="btn" id="ctlBgmPrev" type="button" aria-label="Track anterior">‚èÆ</button>
          <button class="btn" id="ctlBgmPlay" type="button" aria-label="Play/Pausa BGM">‚ñ∂/‚è∏</button>
          <button class="btn" id="ctlBgmNext" type="button" aria-label="Siguiente track">‚è≠</button>
        </div>
        <button class="btn ghost full" id="ctlBgmShuffle" type="button">üîÄ Shuffle</button>
        <div class="hint" id="ctlBgmNow">‚Äî</div>
      </div>

      <!-- TWITCH -->
      <div class="card">
        <div class="cardTitle">Twitch (votos / chat / alerts)</div>

        <label class="row" for="ctlTwitchChannel"><span>Canal</span>
          <input id="ctlTwitchChannel" class="input" type="text" placeholder="globaleyetv" autocomplete="off" />
        </label>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlVoteOn"><span>Votos</span>
            <select id="ctlVoteOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
          </label>
          <label class="row" style="margin:0" for="ctlVoteOverlay"><span>Overlay voto</span>
            <select id="ctlVoteOverlay" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlChatOn"><span>Chat overlay</span>
            <select id="ctlChatOn" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
          </label>
          <label class="row" style="margin:0" for="ctlChatHideCmd"><span>Ocultar cmds</span>
            <select id="ctlChatHideCmd" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
          </label>
        </div>

        <!-- ‚úÖ NUEVO/COMPAT: voteUi (lo usas en URL) -->
        <label class="row" for="ctlVoteUi"><span>UI voto (s)</span>
          <input id="ctlVoteUi" class="input" type="number" min="0" max="600" step="1" value="60" inputmode="numeric" />
        </label>

        <label class="row" for="ctlAlertsOn"><span>Alerts Twitch</span>
          <select id="ctlAlertsOn" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
        </label>

        <label class="row" for="ctlVoteWindow"><span>Duraci√≥n voto (s)</span>
          <input id="ctlVoteWindow" class="input" type="number" min="5" max="180" step="1" value="60" inputmode="numeric" />
        </label>

        <label class="row" for="ctlVoteAt"><span>Auto (a falta)</span>
          <input id="ctlVoteAt" class="input" type="number" min="5" max="600" step="1" value="60" inputmode="numeric" />
        </label>

        <label class="row" for="ctlVoteLead"><span>Pre-aviso (s)</span>
          <input id="ctlVoteLead" class="input" type="number" min="0" max="30" step="1" value="5" inputmode="numeric" />
        </label>

        <label class="row" for="ctlStayMins"><span>STAY ‚Üí re-voto (min)</span>
          <input id="ctlStayMins" class="input" type="number" min="1" max="120" step="1" value="5" inputmode="numeric" />
        </label>

        <label class="row" for="ctlYtCookies"><span>YouTube cookies</span>
          <select id="ctlYtCookies" class="select"><option value="on">ON (sesi√≥n)</option><option value="off">OFF (nocookie)</option></select>
        </label>

        <label class="row" for="ctlVoteCmd"><span>Cmds voto</span>
          <input id="ctlVoteCmd" class="input" type="text" value="!next,!cam|!stay,!keep" autocomplete="off" />
        </label>

        <div class="row2">
          <button id="ctlVoteStart" class="btn full" type="button">üó≥Ô∏è Lanzar voto</button>
          <button id="ctlVoteApply" class="btn ghost full" type="button">Aplicar</button>
        </div>

        <div class="hint">‚úÖ Visible: <b>Pre-aviso + Duraci√≥n</b>. (Empate o 0 votos = NEXT)</div>

        <!-- Aliases ocultos (para control.js que busque otros IDs) -->
        <div style="display:none">
          <select id="ctlChatHideCommands"><option value="on">on</option><option value="off">off</option></select>
          <input id="ctlVoteCommands" type="text" />
        </div>
      </div>

      <!-- ADS OVERLAY -->
      <div class="card">
        <div class="cardTitle">Anuncios (overlay en stream)</div>

        <label class="row" for="ctlAdsOn"><span>Ads overlay</span>
          <select id="ctlAdsOn" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
        </label>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlAdLead"><span>Lead (s)</span>
            <input id="ctlAdLead" class="input" type="number" min="0" max="300" step="1" value="30" inputmode="numeric" />
          </label>
          <label class="row" style="margin:0" for="ctlAdDur"><span>Duraci√≥n (s)</span>
            <input id="ctlAdDur" class="input" type="number" min="5" max="600" step="1" value="30" inputmode="numeric" />
          </label>
        </div>

        <label class="row" for="ctlAdShowDuring"><span>Mostrar durante</span>
          <select id="ctlAdShowDuring" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
        </label>

        <label class="row" for="ctlAdChatText"><span>Msg chat (lead)</span>
          <input id="ctlAdChatText" class="input" type="text" value="‚ö†Ô∏è Anuncio en breve‚Ä¶ ¬°gracias por apoyar el canal! üíú" autocomplete="off" />
        </label>

        <div class="row2">
          <button id="ctlAdNoticeBtn" class="btn full" type="button">‚è≥ Aviso (AD_NOTICE)</button>
          <button id="ctlAdBeginBtn" class="btn full" type="button">‚ñ∂Ô∏è En curso (AD_BEGIN)</button>
        </div>
        <button id="ctlAdClearBtn" class="btn ghost full" type="button" style="margin-top:8px">‚úñÔ∏è Quitar (AD_CLEAR)</button>

        <div class="hint">Tip: cuando Twitch te avisa del ad, pulsa ‚ÄúAviso‚Äù. Si quieres, el bot tambi√©n escribe en chat.</div>

        <!-- Alias oculto -->
        <div style="display:none">
          <select id="ctlAds"><option value="on">on</option><option value="off">off</option></select>
        </div>
      </div>

      <!-- POINTS (placeholder compatible) -->
      <div class="card">
        <div class="cardTitle">Puntos (opcional)</div>
        <div class="hint">Si tu v2.3.9 trae edici√≥n/overlay de puntos, aqu√≠ quedan anclajes para que no ‚Äúfalten‚Äù IDs.</div>

        <label class="row" for="ctlPtsEditOn"><span>Editor puntos</span>
          <select id="ctlPtsEditOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
        </label>

        <label class="row" for="ctlPtsBotName"><span>Nombre bot</span>
          <input id="ctlPtsBotName" class="input" type="text" placeholder="auto / globaleyetv" autocomplete="off" />
        </label>

        <div class="row2">
          <button id="ctlPtsApply" class="btn full" type="button">Aplicar</button>
          <button id="ctlPtsReset" class="btn ghost full" type="button">Reset</button>
        </div>

        <div style="display:none">
          <select id="ctlPtsEdit"><option value="off">off</option><option value="on">on</option></select>
        </div>
      </div>

      <!-- BOT IRC -->
      <div class="card">
        <div class="cardTitle">Bot (manda mensajes al chat)</div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlBotOn"><span>Bot</span>
            <select id="ctlBotOn" class="select"><option value="off">OFF</option><option value="on">ON</option></select>
          </label>
          <div class="pill mono" id="ctlBotStatus" aria-live="polite">Bot OFF</div>
        </div>

        <label class="row" for="ctlBotUser"><span>Usuario bot</span>
          <input id="ctlBotUser" class="input" type="text" placeholder="mi_bot" autocomplete="username" />
        </label>

        <label class="row" for="ctlBotToken"><span>OAuth token</span>
          <input id="ctlBotToken" class="input" type="password" placeholder="oauth:xxxx (o solo xxxx)" autocomplete="current-password" />
        </label>

        <label class="row" for="ctlBotSayOnAd"><span>Escribir en Ads</span>
          <select id="ctlBotSayOnAd" class="select"><option value="on">ON</option><option value="off">OFF</option></select>
        </label>

        <button id="ctlBotConnect" class="btn full" type="button">üîå Conectar bot</button>

        <div class="row2" style="margin-top:10px">
          <input id="ctlBotTestText" class="input" type="text" value="‚úÖ Bot online" autocomplete="off" />
          <button id="ctlBotTestSend" class="btn" type="button">Enviar test</button>
        </div>

        <div class="hint">‚úÖ Esto solo funciona en tu panel (no en el player). No se expone el token en la URL.</div>
      </div>

    </section>

    <footer class="controlFooter" aria-label="Ayuda r√°pida" style="margin-top:14px; opacity:.9">
      <span class="muted">Teclas: ‚Üê/‚Üí navegar ¬∑ Espacio pausa ¬∑ R reshuffle ¬∑ B ban</span>
      <span class="dot">‚Ä¢</span>
      <span class="muted mono" id="ctlBusName">Canal: rlc_bus_v1</span>
    </footer>

    <noscript>
      <div class="card" style="margin-top:12px">
        <div class="cardTitle">JavaScript desactivado</div>
        <div class="hint">Este panel requiere JavaScript para funcionar.</div>
      </div>
    </noscript>
  </main>

  <!-- Captura errores JS y los muestra en pantalla -->
  <script>
    (() => {
      const qs = (s) => document.querySelector(s);
      const showDiag = (msg) => {
        const card = qs("#ctlDiagCard");
        const pre  = qs("#ctlDiagText");
        const st   = qs("#ctlStatus");
        if (card) card.style.display = "block";
        if (pre) pre.textContent = msg;
        if (st) { st.textContent = "Error"; st.classList.add("pill--bad"); }
      };
      window.addEventListener("error", (e) => {
        const lines = [
          `[${new Date().toISOString()}] window.error`,
          `message: ${String(e.message || "")}`,
          `file: ${String(e.filename || "")}:${String(e.lineno || "")}:${String(e.colno || "")}`,
          `stack: ${e.error && e.error.stack ? e.error.stack : "(no stack)"}`
        ];
        showDiag(lines.join("\n"));
      });
      window.addEventListener("unhandledrejection", (e) => {
        const r = e.reason;
        const text = (r && (r.stack || r.message)) ? (r.stack || r.message) : String(r);
        showDiag(`[${new Date().toISOString()}] unhandledrejection\n${text}`);
      });
    })();
  </script>

  <!-- ‚úÖ Alias sync (para que no se rompa si control.js usa IDs alternativos) -->
  <script>
    (() => {
      "use strict";
      const byId = (id) => document.getElementById(id);

      const mirror = (aId, bId) => {
        const a = byId(aId), b = byId(bId);
        if (!a || !b) return;

        let lock = false;
        const syncAtoB = () => { if(lock) return; lock = true; try{ b.value = a.value; } finally{ lock = false; } };
        const syncBtoA = () => { if(lock) return; lock = true; try{ a.value = b.value; } finally{ lock = false; } };

        // init
        syncAtoB();

        // live sync
        a.addEventListener("change", syncAtoB, { passive: true });
        a.addEventListener("input",  syncAtoB, { passive: true });
        b.addEventListener("change", syncBtoA, { passive: true });
        b.addEventListener("input",  syncBtoA, { passive: true });
      };

      // Chat hide commands
      mirror("ctlChatHideCmd", "ctlChatHideCommands");
      // Vote cmds
      mirror("ctlVoteCmd", "ctlVoteCommands");
      // Points edit toggle
      mirror("ctlPtsEditOn", "ctlPtsEdit");
      // KEY aliases
      mirror("ctlKey", "ctlRoomKey");
      mirror("ctlKey", "ctlBusKey");
    })();
  </script>

  <!-- Scripts (cache-bust ALINEADO con APP_VERSION 2.3.9) -->
  <script defer src="./cams.js?v=2.3.9"></script>
  <script defer src="./music.js?v=2.3.9"></script>

  <!-- ‚úÖ Control principal -->
  <script defer src="./control.js?v=2.3.9"></script>

  <!-- Opcionales -->
  <script defer src="./catalogControl.js?v=2.3.9"></script>
  <script defer src="./pointsControl.js?v=2.3.9"></script>
  <script defer src="./rlcTickersControl.js?v=2.3.9"></script>
</body>
</html>
