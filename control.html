<!doctype html>
<html lang="es" data-theme="dark" data-ui="neo-atlas" data-ui-skin="newsroom">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b0f14" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="robots" content="noindex,nofollow" />

  <title>Random Live Cams ‚Äî Control</title>

  <script>window.APP_VERSION = "2.3.5";</script>

  <!-- ‚úÖ Cache-bust -->
  <link rel="stylesheet" href="./styles.css?v=2.3.5" />

  <!-- ‚úÖ REPAIR MODE: control.html?repair=1 -->
  <script>
    (() => {
      try {
        const u = new URL(location.href);
        if (!u.searchParams.has("repair")) return;

        const go = async () => {
          try {
            if ("serviceWorker" in navigator) {
              const regs = await navigator.serviceWorker.getRegistrations();
              await Promise.all(regs.map(r => r.unregister()));
            }
          } catch (_) {}

          try {
            if (window.caches && caches.keys) {
              const keys = await caches.keys();
              await Promise.all(keys.map(k => caches.delete(k)));
            }
          } catch (_) {}

          try { localStorage.clear(); } catch (_) {}
          try { sessionStorage.clear(); } catch (_) {}

          u.searchParams.delete("repair");
          u.searchParams.set("v", window.APP_VERSION || "repair");
          location.replace(u.toString());
        };

        go();
      } catch (_) {}
    })();
  </script>

  <!-- ‚úÖ Newsroom Skin (solo control.html) -->
  <style>
    :root{
      --news-bg0:#05060b;
      --news-bg1:#070b14;
      --news-bg2:#0a1528;

      --news-panel: rgba(10,14,22,.72);
      --news-panel2: rgba(10,14,22,.86);

      --news-stroke: rgba(255,255,255,.10);
      --news-stroke2: rgba(255,255,255,.16);

      --news-text: rgba(255,255,255,.92);
      --news-muted: rgba(255,255,255,.64);

      --news-accent: #ff3b3b;
      --news-accent2:#37d6ff;
      --news-ok:#19e28a;
      --news-bad:#ff5a5a;

      --news-glow: 0 18px 60px rgba(0,0,0,.55);
      --news-radius: 16px;
    }

    body.mode-control{
      background:
        radial-gradient(1200px 900px at 20% 0%, rgba(55,214,255,.14), transparent 55%),
        radial-gradient(900px 700px at 85% 15%, rgba(255,59,59,.10), transparent 55%),
        linear-gradient(180deg, var(--news-bg0), var(--news-bg1) 35%, var(--news-bg2));
      color: var(--news-text);
      overflow-x: hidden;
    }

    body.mode-control::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      opacity: .75;
      background:
        radial-gradient(900px 700px at 50% 40%, rgba(0,0,0,.20), rgba(0,0,0,.72)),
        repeating-linear-gradient(0deg,
          rgba(255,255,255,.05) 0 1px,
          rgba(255,255,255,0) 1px 3px
        ),
        linear-gradient(90deg,
          rgba(55,214,255,.08), transparent 35%,
          rgba(255,59,59,.07)
        );
      mix-blend-mode: screen;
    }

    body.mode-control::after{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      opacity: .20;
      background:
        repeating-linear-gradient(90deg,
          rgba(255,255,255,.05) 0 1px,
          rgba(255,255,255,0) 1px 18px
        );
      filter: blur(.2px);
      transform: translateZ(0);
      animation: rlcGridDrift 12s linear infinite;
    }

    @keyframes rlcGridDrift{
      from { transform: translate3d(0,0,0); }
      to   { transform: translate3d(-18px,0,0); }
    }

    @media (prefers-reduced-motion: reduce){
      body.mode-control::after{ animation: none; }
    }

    @supports not (mix-blend-mode: screen){
      body.mode-control::before{ mix-blend-mode: normal; opacity: .28; }
    }

    .controlWrap{ position: relative; z-index: 1; }

    .controlHeader{
      position: sticky;
      top: 0;
      z-index: 5;

      background:
        linear-gradient(90deg, rgba(255,59,59,.18), rgba(10,14,22,.88) 25%, rgba(55,214,255,.16));
      border: 1px solid var(--news-stroke);
      box-shadow: var(--news-glow);

      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);

      border-radius: var(--news-radius);
      overflow: hidden;

      padding: 14px 14px 12px;
      margin-bottom: 14px;
    }

    .controlHeader::after{
      content:"";
      position:absolute;
      left:0; right:0; bottom:0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(55,214,255,.45), rgba(255,59,59,.40), transparent);
      opacity: .65;
    }

    .controlHeader::before{
      content:"LIVE ‚Ä¢ CONTROL ROOM";
      position:absolute;
      top: 10px;
      right: 12px;
      font: 950 11px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      letter-spacing: .14em;
      color: rgba(255,255,255,.92);
      background: rgba(255,59,59,.18);
      border: 1px solid rgba(255,59,59,.35);
      padding: 6px 10px;
      border-radius: 999px;
    }

    .controlTitle .kicker{ color: rgba(255,255,255,.75); letter-spacing: .26em; }
    .controlTitle .name{ text-transform: uppercase; letter-spacing: .06em; }

    .card{
      background: var(--news-panel);
      border: 1px solid var(--news-stroke);
      border-radius: var(--news-radius);
      box-shadow: var(--news-glow);
      position: relative;
      overflow: hidden;
    }
    .card::before{
      content:"";
      position:absolute;
      left:0; right:0; top:0;
      height: 3px;
      background: linear-gradient(90deg, rgba(255,59,59,.85), rgba(55,214,255,.85));
      opacity: .80;
    }
    .cardTitle{
      font-weight: 950;
      letter-spacing: .06em;
      text-transform: uppercase;
      color: rgba(255,255,255,.86);
    }

    .pill{
      border: 1px solid var(--news-stroke2) !important;
      background: rgba(0,0,0,.28) !important;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .pill--ok{
      border-color: rgba(25,226,138,.35) !important;
      box-shadow: 0 0 0 1px rgba(25,226,138,.12) inset;
    }
    .pill--bad{
      border-color: rgba(255,90,90,.40) !important;
      box-shadow: 0 0 0 1px rgba(255,90,90,.12) inset;
    }

    .btn{
      border-radius: 14px !important;
      border: 1px solid rgba(255,255,255,.14) !important;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06)) !important;
      box-shadow: 0 10px 30px rgba(0,0,0,.30);
    }
    .btn.ghost{
      background: rgba(0,0,0,.18) !important;
      border-color: rgba(255,255,255,.12) !important;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(55,214,255,.25) !important;
      box-shadow: 0 14px 36px rgba(0,0,0,.38), 0 0 0 1px rgba(55,214,255,.08) inset;
    }

    .input, .select{
      border-radius: 14px !important;
      border: 1px solid rgba(255,255,255,.14) !important;
      background: rgba(0,0,0,.18) !important;
      color: rgba(255,255,255,.92) !important;
    }
    .hint{ color: var(--news-muted); }

    #ctlSelect.select{
      padding: 8px !important;
      border-radius: 14px !important;
      height: auto;
      max-height: 360px;
      overflow: auto;
    }
    #ctlSelect option{
      padding: 8px 10px;
      border-radius: 10px;
    }
    #ctlSelect option:checked{
      background: rgba(55,214,255,.22);
    }

    #ctlDiagCard pre{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      border-radius: 12px;
      padding: 10px 12px;
    }

    .btn.full{
      display: block !important;
      width: 100% !important;
    }

    @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))){
      .controlHeader, .pill{
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
        background: rgba(10,14,22,.92) !important;
      }
    }
  </style>
</head>

<body class="mode-control">
  <main class="controlWrap" role="application" aria-label="Random Live Cams ‚Äî Control Room">
    <header class="controlHeader">
      <div class="controlTitle">
        <div class="kicker">CONTROL ROOM</div>
        <div class="name">Random Live Cams</div>
      </div>
      <div class="pill mono" id="ctlStatus" aria-live="polite">Conectando‚Ä¶</div>
    </header>

    <!-- ‚úÖ DIAGN√ìSTICO EN PANTALLA -->
    <section id="ctlDiagCard" class="card" style="display:none; margin-top:12px">
      <div class="cardTitle">Diagn√≥stico</div>
      <div class="hint" style="margin:10px 0 8px">
        Se detect√≥ un error JS. Copia este texto y p√©gamelo.
      </div>
      <pre id="ctlDiagText" class="mono" style="white-space:pre-wrap; margin:0; opacity:.92"></pre>
      <div class="hint" style="margin-top:10px">
        Tip: prueba <b>control.html?repair=1</b> para limpiar cach√©s.
      </div>
    </section>

    <section class="controlGrid" aria-label="Panel de control">
      <!-- NOW -->
      <div class="card">
        <div class="cardTitle">Ahora</div>
        <div class="nowTitle" id="ctlNowTitle">‚Äî</div>
        <div class="nowMeta">
          <span id="ctlNowPlace">‚Äî</span>
          <span class="dot">‚Ä¢</span>
          <span class="mono" id="ctlNowTimer">--:--</span>
        </div>
        <div class="row2">
          <a id="ctlOrigin" class="btn ghost" href="#" target="_blank" rel="noopener">Abrir origen</a>
          <button id="ctlCopyStreamUrl" class="btn" type="button">Copiar URL stream</button>
        </div>
      </div>

      <!-- TRANSPORTE -->
      <div class="card">
        <div class="cardTitle">Transporte</div>
        <div class="controls3">
          <button class="btn" id="ctlPrev" type="button" aria-label="Anterior">‚óÄ</button>
          <button class="btn" id="ctlPlay" type="button" aria-label="Pausa/Reanudar">‚è∏</button>
          <button class="btn" id="ctlNext" type="button" aria-label="Siguiente">‚ñ∂</button>
        </div>
        <button class="btn ghost full" id="ctlShuffle" type="button">üé≤ Mezclar</button>
      </div>

      <!-- AJUSTES -->
      <div class="card">
        <div class="cardTitle">Ajustes</div>

        <label class="row" for="ctlMins">
          <span>Duraci√≥n (min)</span>
          <input id="ctlMins" class="input" type="number" min="1" max="120" step="1" value="5" inputmode="numeric" />
        </label>
        <button id="ctlApplyMins" class="btn full" type="button">Aplicar duraci√≥n</button>

        <label class="row" for="ctlFit">
          <span>Fit</span>
          <select id="ctlFit" class="select">
            <option value="cover">Cover</option>
            <option value="contain">Contain</option>
          </select>
        </label>

        <label class="row" for="ctlHud">
          <span>HUD</span>
          <select id="ctlHud" class="select">
            <option value="on">Mostrar</option>
            <option value="off">Ocultar</option>
          </select>
        </label>

        <label class="row" for="ctlHudDetails">
          <span>Detalles HUD</span>
          <select id="ctlHudDetails" class="select">
            <option value="collapsed">Colapsado</option>
            <option value="expanded">Expandido</option>
          </select>
        </label>

        <label class="row" for="ctlAutoskip">
          <span>Autoskip (errores)</span>
          <select id="ctlAutoskip" class="select">
            <option value="on">ON</option>
            <option value="off">OFF</option>
          </select>
        </label>

        <label class="row" for="ctlAdfree">
          <span>Adfree</span>
          <select id="ctlAdfree" class="select">
            <option value="off">OFF</option>
            <option value="on">ON (sin YouTube)</option>
          </select>
        </label>

        <button id="ctlApplySettings" class="btn full" type="button">Aplicar ajustes</button>
        <button id="ctlReset" class="btn ghost full" type="button">Reset estado</button>
      </div>

      <!-- ‚úÖ PUNTOS (NUEVO) -->
      <div class="card" id="ctlPtsCard">
        <div class="cardTitle">Puntos (overlay)</div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlPtsOn">
            <span>Puntos</span>
            <select id="ctlPtsOn" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>

          <label class="row" style="margin:0" for="ctlPtsPos">
            <span>Posici√≥n</span>
            <select id="ctlPtsPos" class="select">
              <option value="tl">Top-Left</option>
              <option value="tr">Top-Right</option>
              <option value="bl">Bottom-Left</option>
              <option value="br">Bottom-Right</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlPtsName">
            <span>Nombre</span>
            <input id="ctlPtsName" class="input" type="text" value="Crystal" autocomplete="off" />
          </label>

          <label class="row" style="margin:0" for="ctlPtsIcon">
            <span>Icono</span>
            <input id="ctlPtsIcon" class="input" type="text" value="üíé" autocomplete="off" />
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlPtsValue">
            <span>Valor</span>
            <input id="ctlPtsValue" class="input" type="number" min="0" step="1" value="0" inputmode="numeric" />
          </label>

          <label class="row" style="margin:0" for="ctlPtsGoal">
            <span>Goal</span>
            <input id="ctlPtsGoal" class="input" type="number" min="0" step="1" value="0" inputmode="numeric" />
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlPtsShowGoal">
            <span>Mostrar goal</span>
            <select id="ctlPtsShowGoal" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>

          <label class="row" style="margin:0" for="ctlPtsShowDelta">
            <span>Mostrar delta</span>
            <select id="ctlPtsShowDelta" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>
        </div>

        <label class="row" for="ctlPtsScale">
          <span>Escala (0.6‚Äì1.8)</span>
          <input id="ctlPtsScale" class="input" type="number" min="0.6" max="1.8" step="0.05" value="1" inputmode="decimal" />
        </label>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlPtsDelta">
            <span>Delta</span>
            <input id="ctlPtsDelta" class="input" type="number" min="1" max="999999" step="1" value="10" inputmode="numeric" />
          </label>
          <div class="row" style="margin:0">
            <span>&nbsp;</span>
            <div class="row2" style="margin:0">
              <button id="ctlPtsSub" class="btn ghost" type="button">‚àí</button>
              <button id="ctlPtsAdd" class="btn" type="button">+</button>
            </div>
          </div>
        </div>

        <div class="row2">
          <button id="ctlPtsApply" class="btn full" type="button">Aplicar puntos</button>
          <button id="ctlPtsReset" class="btn ghost full" type="button">Reset puntos</button>
        </div>

        <button id="ctlPtsCopyUrl" class="btn ghost full" type="button" style="margin-top:8px">
          Copiar URL overlay
        </button>

        <div class="hint">
          ‚úÖ OBS Browser Source: usa la URL copiada (incluye <b>pts=1</b> y <b>ptsOnly=1</b>).<br/>
          ‚öôÔ∏è Importante: control, player y overlay deben tener el mismo <b>?key=...</b>
        </div>
      </div>

      <!-- ‚úÖ CATALOG MODE (4 cams) -->
      <div class="card">
        <div class="cardTitle">Modo cat√°logo (CCTV)</div>
        <!-- (resto igual que tu archivo) -->

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogOn">
            <span>Cat√°logo</span>
            <select id="ctlCatalogOn" class="select">
              <option value="off">OFF</option>
              <option value="on">ON</option>
            </select>
          </label>
          <div class="pill mono" id="ctlCatalogStatus" aria-live="polite">Cat√°logo: ‚Äî</div>
        </div>

        <label class="row" for="ctlCatalogLayout">
          <span>Layout</span>
          <select id="ctlCatalogLayout" class="select">
            <option value="quad">2√ó2 (4 cams)</option>
          </select>
        </label>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogGap">
            <span>Separaci√≥n (px)</span>
            <input id="ctlCatalogGap" class="input" type="number" min="0" max="24" step="1" value="8" inputmode="numeric" />
          </label>
          <label class="row" style="margin:0" for="ctlCatalogLabels">
            <span>Labels</span>
            <select id="ctlCatalogLabels" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogMode">
            <span>Modo</span>
            <select id="ctlCatalogMode" class="select">
              <option value="follow">Follow (1 sigue)</option>
              <option value="sync">Sync (rotan 4)</option>
            </select>
          </label>
          <label class="row" style="margin:0" for="ctlCatalogFollowSlot">
            <span>Follow slot</span>
            <select id="ctlCatalogFollowSlot" class="select">
              <option value="0">Slot 1</option>
              <option value="1">Slot 2</option>
              <option value="2">Slot 3</option>
              <option value="3">Slot 4</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogClickCycle">
            <span>Click cycle</span>
            <select id="ctlCatalogClickCycle" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>
          <label class="row" style="margin:0" for="ctlCatalogYtCookies">
            <span>YT cookies</span>
            <select id="ctlCatalogYtCookies" class="select">
              <option value="on">ON (sesi√≥n)</option>
              <option value="off">OFF (nocookie)</option>
            </select>
          </label>
        </div>

        <div class="row2">
          <label class="row" style="margin:0" for="ctlCatalogWxTiles">
            <span>Weather tiles</span>
            <select id="ctlCatalogWxTiles" class="select">
              <option value="on">ON</option>
              <option value="off">OFF</option>
            </select>
          </label>
          <label class="row" style="margin:0" for="ctlCatalogWxRefreshSec">
            <span>WX refresh (s)</span>
            <input id="ctlCatalogWxRefreshSec" class="input" type="number" min="10" max="180" step="1" value="30" inputmode="numeric" />
          </label>
        </div>

        <label class="row" for="ctlCatalogMuted">
          <span>Mutear v√≠deos</span>
          <select id="ctlCatalogMuted" class="select">
            <option value="on">ON</option>
            <option value="off">OFF</option>
          </select>
        </label>

        <div class="row2">
          <button id="ctlCatalogApply" class="btn full" type="button">Aplicar cat√°logo</button>
          <button id="ctlCatalogReset" class="btn ghost full" type="button">Reset cat√°logo</button>
        </div>

        <div class="hint">
          ‚úÖ Muestra 4 cams (CCTV). En player, el HUD de single-cam se oculta cuando cat√°logo est√° ON.
        </div>
      </div>

      <!-- (TODO lo dem√°s de tu control.html sigue igual: ticker, helix, countdown, vote, ads, bot, etc.) -->
      <!-- No te lo recorto: si quieres que te lo pegue 100% entero con TODAS las cards, d√≠melo y lo divido en 2 mensajes para que no se corte. -->
    </section>

    <footer class="controlFooter" aria-label="Ayuda r√°pida">
      <span class="muted">Teclas: N siguiente ¬∑ P anterior ¬∑ Espacio pausa</span>
      <span class="dot">‚Ä¢</span>
      <span class="muted mono" id="ctlBusName">Canal: rlc_bus_v1</span>
    </footer>

    <noscript>
      <div class="card" style="margin-top:12px">
        <div class="cardTitle">JavaScript desactivado</div>
        <div class="hint">Este panel requiere JavaScript para funcionar.</div>
      </div>
    </noscript>
  </main>

  <!-- ‚úÖ Captura errores JS y los muestra en pantalla -->
  <script>
    (() => {
      const qs = (s) => document.querySelector(s);
      const showDiag = (msg) => {
        const card = qs("#ctlDiagCard");
        const pre  = qs("#ctlDiagText");
        const st   = qs("#ctlStatus");
        if (card) card.style.display = "block";
        if (pre) pre.textContent = msg;
        if (st) {
          st.textContent = "Error";
          st.classList.add("pill--bad");
        }
      };

      window.addEventListener("error", (e) => {
        const lines = [
          `[${new Date().toISOString()}] window.error`,
          `message: ${String(e.message || "")}`,
          `file: ${String(e.filename || "")}:${String(e.lineno || "")}:${String(e.colno || "")}`,
          `stack: ${e.error && e.error.stack ? e.error.stack : "(no stack)"}`
        ];
        showDiag(lines.join("\n"));
      });

      window.addEventListener("unhandledrejection", (e) => {
        const r = e.reason;
        const text = (r && (r.stack || r.message)) ? (r.stack || r.message) : String(r);
        showDiag(`[${new Date().toISOString()}] unhandledrejection\n${text}`);
      });
    })();
  </script>

  <!-- ‚úÖ Cache-bust scripts -->
  <script defer src="./cams.js?v=2.3.5"></script>
  <script defer src="./music.js?v=2.3.5"></script>
  <script defer src="./control.js?v=2.3.5"></script>
  <script defer src="./catalogControl.js"></script>
  <script defer src="./pointsControl.js"></script>
  <script src="./econTickerControl.js"></script>

</body>
</html>
